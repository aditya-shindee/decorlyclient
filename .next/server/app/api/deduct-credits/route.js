(()=>{var e={};e.id=777,e.ids=[777],e.modules={20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},14300:e=>{"use strict";e.exports=require("buffer")},6113:e=>{"use strict";e.exports=require("crypto")},82361:e=>{"use strict";e.exports=require("events")},13685:e=>{"use strict";e.exports=require("http")},95687:e=>{"use strict";e.exports=require("https")},41808:e=>{"use strict";e.exports=require("net")},85477:e=>{"use strict";e.exports=require("punycode")},12781:e=>{"use strict";e.exports=require("stream")},24404:e=>{"use strict";e.exports=require("tls")},57310:e=>{"use strict";e.exports=require("url")},59796:e=>{"use strict";e.exports=require("zlib")},58359:()=>{},93739:()=>{},75750:(e,t,r)=>{"use strict";r.r(t),r.d(t,{originalPathname:()=>x,patchFetch:()=>q,requestAsyncStorage:()=>p,routeModule:()=>d,serverHooks:()=>l,staticGenerationAsyncStorage:()=>m});var s={};r.r(s),r.d(s,{POST:()=>c});var u=r(49303),i=r(88716),o=r(60670),n=r(85662),a=r(87070);async function c(e){try{let{searchParams:t}=new URL(e.url),r=t.get("userId"),s=t.get("amount");if(!r)return a.NextResponse.json({error:"User ID is required"},{status:400});if(!s)return a.NextResponse.json({error:"amount is required"},{status:400});let u=parseInt(s);if(isNaN(u)||u<=0)return a.NextResponse.json({error:"Valid amount is required"},{status:400});let{data:i,error:o}=await n.O.from("credits").select("amount").eq("user_id",r).single();if(o)return a.NextResponse.json({error:"Failed to fetch current credits"},{status:500});if(i.amount<u)return a.NextResponse.json({error:"Insufficient credits"},{status:400});let{data:c,error:d}=await n.O.from("credits").update({amount:i.amount-u}).eq("user_id",r).select("amount").single();if(d)return a.NextResponse.json({error:"Failed to deduct credits"},{status:500});return a.NextResponse.json({success:!0,previousAmount:i.amount,newAmount:c.amount,deductedAmount:u})}catch(e){return console.error("Error deducting credits:",e),a.NextResponse.json({error:"Internal server error"},{status:500})}}let d=new u.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/deduct-credits/route",pathname:"/api/deduct-credits",filename:"route",bundlePath:"app/api/deduct-credits/route"},resolvedPagePath:"/home/project/app/api/deduct-credits/route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:p,staticGenerationAsyncStorage:m,serverHooks:l}=d,x="/api/deduct-credits/route";function q(){return(0,o.patchFetch)({serverHooks:l,staticGenerationAsyncStorage:m})}},85662:(e,t,r)=>{"use strict";r.d(t,{O:()=>s});let s=(0,r(72438).eI)("https://xzecfauvsumzwqgquzga.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inh6ZWNmYXV2c3VtendxZ3F1emdhIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDg3NzQ3MzcsImV4cCI6MjA2NDM1MDczN30.rUBzaJpA6rjlSER6FcZnm-DR-Pd2Qh1TMNkiiyv52Mc")}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[510,922],()=>r(75750));module.exports=s})();